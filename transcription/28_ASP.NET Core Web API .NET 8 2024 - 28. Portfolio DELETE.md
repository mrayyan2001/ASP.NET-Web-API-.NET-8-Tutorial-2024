so delete is going to be the last API endpoint that we need for the portfolio controller Delite is not going to be that much different from any other API endpoint plus we've coded out pretty much all the infrastructure that we need to carry out the delete but let's just talk about how this is going to work with a little bit of pseudo code first things first we have to get the user the user is associated with the stock and we're going to get the user from the identity claims extension that we made previously second we are going to get the portfolio we coded up a method that gets all the portfolio items so that's pretty much figured out number three is we're going to filter out all the other portfolio items with the symbol that we passed into the actual API endpoint and last but not least we do a good old delete and we will be on our way so let's go ahead let's hop over into vs code and let's build it okay so I am inside the portfolio controller right now I'm going to scroll past the ad portfolio I'm going to go down here I'm go ahead and start making an HTTP delete so HTTP delete because obviously we are deleting we're going to authorize this because we have to have the user and we're going to go ahead declare a async function that's going to return an ey action result so delete portfolio delete portfolio and going to pass in a string and a symbol go down first things first we're going to have to get the username that's associated with the user we're going to pull this out of the claims no surprises there um also we have to get our app user so I'm going to go ahead declare variable app user and we're going to await use the user manager go into here find by name async and we're going to pass in our username um we could check if the app user is there but because the authorizer is there I'm not going to but feel free to add a null check for the app user if you want to so next thing we're going to go get all of the um stocks in the user portfolio so I'm going to say await we're going to use this nice little method that we made so portfolio repo we're going to get user portfolio and we're going to pass in the app user okay looking good now that we have the user portfolio we can compare the user portfolio with the symbol that was passed into the actual API endpoint and we can filter it out and check if it's there so I'm going to say uh VAR filtered stock and I'm going to go ahead and filter this data that we got back from the database I'm going to use a wear we're going to say s is equal to um s. symbol and we're going to compare this like I said with the symbol that we pass into the actual API endpoint and also just for safety I'm going to check if this is or uh I'm going to to lower this so this will go ahead and lower lowercase everything just to do some type of cleaning although I think it's still actually I think it still will actually do it but let's just go ahead in here and uh double or uh be sure so I'm going to go into here I'm going to go to list we don't need async because we're not going to the database and we're going to check the filter stock and if the count is equal to one so if it exists within this actual list we can go down into here we want to say await portfolio repo we want to say delete portfolio so delete dot oh we don't actually have it yet so let's go ahead let's create it and we're going to go into our I portfolio repository and I'm going to just uh make another method and we're going to call this portfolio so I'm going to go into here I'm going to say delete portfolio I'm going to pass in the app user um me see so app user and I'm going to pass in the string it's going to be a symbol and we're good to go so let's go inside of our portfolio repository and go ahead and implement it because we have a red squiggly line and let's go ahead and make this method so we're going to use this repository method so that we can just toss in the app user and the symbol we could have just made it made it so that you just put the object in there but I wanted this delete portfolio method to be pretty modular so we're going to make it so that we fetch the model within the delete portfolio so I'm going to go await context portfolios is equal to first or default async good old Good Old Faithful first or default async right okay x.a user ID and we're going to say user. ID so the user that we passed in so it's app user I'm going to say ID and it also so it needs to be an and we're going to check the stock so we're going to make sure that the stock uh ID is equal to the S the symbol that we pass in so we're going to say symbol and and I'm going to say two lower so two lower and we're going to pass in symbol do to lower so same exact thing okay that looks good now we've got the portfolio model let's do a null check so I'm going to say portfolio model is equal to null and we're going to return null looking good and after that this is when we're going to bring in our context going to bring in our portfolios and we're going to do the remove so remove go ahead just toss in that portfolio model going to await context. saave changes async and we're going to return the portfolio model so return portfolio model okay that looks great so let's go ahead let's go back into our portfolio controller and we're going to do our delete portfolio and this is where we're going to pass in the app user and we are going to pass in the symbol so app user going to pass in the symbol and we are good to go also we're going to do an L so if the filtered stock is not there I'm going to bring this down so filter stock is not there we are going to return batter request stock stock is not in your portfolio so batter request stock is not stock not in your portfolio okay looking good and then lastly we're going to return okay so if everything goes okay we're going to return okay we should be good to go so I'm going to go ahead do a cold restart and we are going to test it out so we are within Swagger right now make sure that you're logged in make sure that the little lock has uh been closed and has the beard token if you don't know how to do that you log in right here we're going to go down we're going to first things first let's get everything in our portfolio so we have Tesla we have Palante here now let's go ahead we're going to delete both of them and then we're going to add both of them so we're going to say delete Tesla got success go down Tesla is not there then we're going to delete Palante here so pltr and then we're going to check and not there so let's go ahead do our post so let's do Tesla again looking good and then let's do paler so pltr go ahead add it and let me see yep we now have P tier hope that you guys enjoyed this if you did make sure to smash that like button smash that subscribe Button as always thank you for watching