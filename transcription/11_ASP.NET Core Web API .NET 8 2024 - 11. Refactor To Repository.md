okay guys so in this video we are going to be refactoring to the repository pattern and what this is going to entail is taking our old database code that looks like this and putting them inside of neat little functions that exist within a repository because remember a repository is just there for database calls and that's what we are going to be doing so let's go ahead hop inside Visual Studio code and first things first we're going to start working on our interface now for our first interface signature we are going to have a get by ID async and this makes sense because we need to get stuff by ID from the database and also we have this little question mark here because our get by ID async is going to have a first or default in it and first or defaults can be null so whenever a first or default doesn't find something it returns null so we need that little question mark there next thing that we're going to do is we are going to return a stock but this one's not going to have the ability to be null because it's a create async and this create async is going to take in our stock and it's going to uh be a stock entity so I'm going to call it a stock model but feel free to call it whatever you want to so next thing is we're going to have a stock it has we're going to have a return type of a stock and it has the ability to be null and we're going to say async but this one's going to be a little bit different because we need the ID and we are also going to return the update stock request so we're going to say update see here update stock request dto and we're going to take in the stock dto just like this so next thing we're going to go down and we are going to pass in the stock let me see here we're going to have a delete async just like this and this delete async is going to take in an INT it's also going to take in an ID just like that all right so now that we have all of this figured out you're going to get a RIS Squigly line because this class is not inter implementing our interface remember that whenever you implement an interface it's a contract and we have a contract with our stock repository that our stock repository must abide by or we're going to quote unquote Sue said stock repository okay I'm getting a little carried away here so next thing that we're going to do is of course make this async a lot of times the lter will add the async for you but I'm on a Mac right now and for some reason it doesn't automatically add the async but but yours might or might not but just remember always add the async and always check that the async is there so I'm going to go add async and of course we're saving our model so we're going to go ahead pass in our model next thing I'm going to do is go into here going to go context so and I'm going to save changes async remember to make it async and then of course we are going to return after we get done we're going to return the stock model great now what we need to do is we need to do our delete and before that I'm actually going to make sure to add my async and we're going to go here we need to go fetch our existing stock model so I'm going to go here I'm going to go context I'm going to go stocks I'm going to go first or default async and we need to go ahead check beforehand so I'm going to go X let's see here x. is equal to ID and we need the first or default because first or default remember returns null and we're anticipating it with the question mark up there so I'm going to go stock model is equal to null and we need to return then we're going to return null back looks good then I'm going to go down here so next thing I'm going to do I'm going to go context uh stocks going to go remove and we're going to pass in the stock model also remove does not have async so remember not to put the async there so we're going to go context here then we're going to go save changes async then after this we're going to return the stock model looking good get all async so also let's go into here um for some reason this did not actually uh become async before so we're going to go ahead and add async to this and next thing we're going to do is get by ID async I'm going to go return go context stocks go find async so find async and we're going to go ahead pass in this ID and also need to make sure that this is at a weit and make sure that this is async so next thing we need to do is we need to do our update and go here we're going to go ahead add async first things first we need to check if it exists so I'm going to say existing stock is equal to await need to go Contex stocks first or default so I'm going to go first or default async X is equal to x. and go ahead pass in the ID so now what we're going to do is we're going to check if the existing stock is equal to null if it is null we are going to return null looking good now what we need to do is we need to actually go within our controller and we could type all this out but I think that typing all this out would be uh mental Hill so what I'm going to do is just go into the controller I'm going to go into the update and I'm just going to go ahead and grab it and what we're going to do is take the existing stock and just go boom boom boom boom boom boom looking good then we are going to change it over to our stock dto so we'll say stock dto looking good go back over here go down and we're going to do our await go context we're going to go save changes a sync then after that we are going to return the existing stock model so we're going to say return existing stock so now that we have our repository made we're going to start going over to our controller and start swapping out all of this code and first thing I'm going to do is just go down to my get by ID our get all is already done but our get by ID we need to go down here and we need to switch it out with the stock REO and we are going to add our git by ID async and go to here go ahead pass in our ID so moving on to our create we'll just go down here we can actually get rid of both of these lines I'm going to go await I'm going to go within the stock repo I'm going to go create and we'll just go into here pass in our stock model just like that looking amazing so now what we need to do is go to our update we can actually get rid of this right here we can get rid of this we can get get rid of this just go ahead and go here and what we can do is go stock repo and pass in our update async Go pass in our ID and pass in the update dto so we go update dto and put a semicolon we're good to go on that now what we need to do is just get rid of this then we can go here here get rid of all of this and we're going to do it this code is going to be looking amazing so we're going to go to here go ahead pass in our ID and would you look at that our code is looking a lot better okay so let's go ahead here and we're going to go ahead restart the server for good measure and let's test everything out so I've already got a couple values within the database already got some dummy Valu so we've got Amazon also added to add a also added another string stock just to test so let's test to make sure that we can create going to go into here and going to say Tesla going to give it a company named Tesla purchase price we'll say $234 um last dividend we'll say 2.1 indust automotive and the market cap we will put uh a large number here so go ahead test it and we've got a response let's also do our get I believe this one that was created was a four so let's go ahead test it to make sure that we can get our four back we've got Tesla go ahead let's also um test it and we'll go ahead just change everything to string see here and would you look at that we've already got our changes back everything's looking good we even have the idid there which is looking great and let's see here make sure that we can delete it so going to here I've got a 204 that's looking good and I'm just going to go back up and make sure that it actually deleted it out and there is no number four we've successfully got all of our database calls refactor to repository let's go ahead let's move on to the next video